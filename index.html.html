<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solo Travelers Overlap Finder</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            background: linear-gradient(135deg, #9333ea 0%, #ec4899 50%, #f97316 100%);
            min-height: 100vh;
            padding: 1rem;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .title-container {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        h1 {
            font-size: 1.875rem;
            font-weight: 700;
            color: #1f2937;
        }
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.3s;
        }
        .btn-primary {
            background: #9333ea;
            color: white;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .btn-primary:hover {
            background: #7e22ce;
        }
        .btn-secondary {
            background: #d1d5db;
            color: #374151;
        }
        .btn-secondary:hover {
            background: #9ca3af;
        }
        .btn-sm {
            padding: 0.5rem;
        }
        .form-container {
            background: #faf5ff;
            padding: 1.5rem;
            border-radius: 0.75rem;
            border: 2px solid #e9d5ff;
            margin-bottom: 1.5rem;
        }
        .form-title {
            font-size: 1.125rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }
        .form-group {
            margin-bottom: 1rem;
        }
        label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
        }
        input, select {
            width: 100%;
            padding: 0.5rem 1rem;
            border: 2px solid #e9d5ff;
            border-radius: 0.5rem;
            font-size: 1rem;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #9333ea;
        }
        .city-row {
            background: white;
            padding: 1rem;
            border-radius: 0.5rem;
            border: 2px solid #e9d5ff;
            margin-bottom: 0.75rem;
        }
        .city-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
        }
        @media (min-width: 768px) {
            .city-grid {
                grid-template-columns: 1fr 1fr 1fr;
            }
            h1 {
                font-size: 1.875rem;
            }
        }
        .city-row-container {
            display: flex;
            gap: 0.75rem;
            align-items: start;
        }
        .city-row-container > div:first-child {
            flex: 1;
        }
        .btn-add-city {
            color: #9333ea;
            font-weight: 600;
            margin-top: 0.75rem;
            background: none;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .btn-add-city:hover {
            color: #7e22ce;
        }
        .btn-group {
            display: flex;
            gap: 0.75rem;
            margin-top: 1rem;
        }
        .empty-state {
            text-align: center;
            padding: 3rem 1.5rem;
        }
        .empty-icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 1rem;
        }
        .empty-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #4b5563;
            margin-bottom: 0.5rem;
        }
        .empty-text {
            color: #6b7280;
        }
        .traveler-card {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: box-shadow 0.3s;
        }
        .traveler-card:hover {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .traveler-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 1rem;
        }
        .traveler-name {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        .traveler-interests {
            color: #4b5563;
            margin-bottom: 0.75rem;
        }
        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }
        .btn-icon {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            transition: color 0.3s;
        }
        .btn-edit {
            color: #3b82f6;
        }
        .btn-edit:hover {
            color: #1d4ed8;
        }
        .btn-delete {
            color: #ef4444;
        }
        .btn-delete:hover {
            color: #b91c1c;
        }
        .city-card {
            background: #f9fafb;
            padding: 1rem;
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb;
            margin-bottom: 1rem;
        }
        .city-name {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #9333ea;
            font-weight: 600;
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
        }
        .city-dates {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #4b5563;
            margin-bottom: 0.75rem;
            font-size: 0.875rem;
        }
        .overlap-container {
            background: #f0fdf4;
            border: 2px solid #bbf7d0;
            border-radius: 0.5rem;
            padding: 0.75rem;
            margin-top: 0.75rem;
        }
        .overlap-header {
            font-weight: 600;
            color: #166534;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .overlap-item {
            background: white;
            padding: 0.5rem;
            border-radius: 0.375rem;
            border: 1px solid #bbf7d0;
            margin-bottom: 0.5rem;
        }
        .overlap-item:last-child {
            margin-bottom: 0;
        }
        .overlap-name-date {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.25rem;
        }
        .overlap-name {
            font-weight: 600;
            color: #1f2937;
            font-size: 0.875rem;
        }
        .overlap-dates {
            font-size: 0.75rem;
            color: #4b5563;
        }
        .overlap-interests {
            font-size: 0.75rem;
            color: #4b5563;
        }
        .footer {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 0.75rem;
            padding: 1rem;
            text-align: center;
            font-size: 0.875rem;
            color: #4b5563;
        }
        .footer p {
            margin-bottom: 0.5rem;
        }
        .footer p:last-child {
            margin-bottom: 0;
        }
        svg {
            width: 20px;
            height: 20px;
        }
        .icon-sm {
            width: 16px;
            height: 16px;
        }
        .icon-lg {
            width: 64px;
            height: 64px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        const { useState, useEffect, createElement: e } = React;

        const THAILAND_CITIES = [
            'Bangkok', 'Chiang Mai', 'Phuket', 'Pattaya', 'Krabi', 'Koh Samui',
            'Koh Phi Phi', 'Ayutthaya', 'Hua Hin', 'Koh Tao', 'Koh Phangan',
            'Chiang Rai', 'Pai', 'Railay Beach', 'Kanchanaburi', 'Sukhothai',
            'Khao Lak', 'Koh Lanta', 'Koh Chang', 'Cha-Am'
        ].sort();

        const Icons = {
            Plus: () => e('svg', { viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2' },
                e('line', { x1: '12', y1: '5', x2: '12', y2: '19' }),
                e('line', { x1: '5', y1: '12', x2: '19', y2: '12' })
            ),
            X: () => e('svg', { viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2' },
                e('line', { x1: '18', y1: '6', x2: '6', y2: '18' }),
                e('line', { x1: '6', y1: '6', x2: '18', y2: '18' })
            ),
            Users: () => e('svg', { viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2' },
                e('path', { d: 'M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2' }),
                e('circle', { cx: '9', cy: '7', r: '4' }),
                e('path', { d: 'M23 21v-2a4 4 0 0 0-3-3.87' }),
                e('path', { d: 'M16 3.13a4 4 0 0 1 0 7.75' })
            ),
            MapPin: () => e('svg', { viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2' },
                e('path', { d: 'M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z' }),
                e('circle', { cx: '12', cy: '10', r: '3' })
            ),
            Calendar: () => e('svg', { className: 'icon-sm', viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2' },
                e('rect', { x: '3', y: '4', width: '18', height: '18', rx: '2', ry: '2' }),
                e('line', { x1: '16', y1: '2', x2: '16', y2: '6' }),
                e('line', { x1: '8', y1: '2', x2: '8', y2: '6' }),
                e('line', { x1: '3', y1: '10', x2: '21', y2: '10' })
            ),
            Trash: () => e('svg', { viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2' },
                e('polyline', { points: '3 6 5 6 21 6' }),
                e('path', { d: 'M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2' })
            ),
            Edit: () => e('svg', { viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2' },
                e('path', { d: 'M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7' }),
                e('path', { d: 'M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z' })
            )
        };

        function TravelOverlapApp() {
            const [travelers, setTravelers] = useState([]);
            const [showForm, setShowForm] = useState(false);
            const [editingId, setEditingId] = useState(null);
            const [formData, setFormData] = useState({
                name: '',
                interests: '',
                cities: [{ city: '', startDate: '', endDate: '' }]
            });

            useEffect(() => {
                loadData();
            }, []);

            const loadData = () => {
                try {
                    const stored = localStorage.getItem('travelers-data');
                    if (stored) {
                        setTravelers(JSON.parse(stored));
                    }
                } catch (error) {
                    console.log('No existing data found');
                }
            };

            const saveData = (data) => {
                try {
                    localStorage.setItem('travelers-data', JSON.stringify(data));
                } catch (error) {
                    console.error('Error saving data:', error);
                }
            };

            const addCityField = () => {
                setFormData({
                    ...formData,
                    cities: [...formData.cities, { city: '', startDate: '', endDate: '' }]
                });
            };

            const removeCityField = (index) => {
                const newCities = formData.cities.filter((_, i) => i !== index);
                setFormData({ ...formData, cities: newCities });
            };

            const updateCity = (index, field, value) => {
                const newCities = [...formData.cities];
                newCities[index][field] = value;
                setFormData({ ...formData, cities: newCities });
            };

            const handleSubmit = () => {
                if (!formData.name) {
                    alert('Please enter your name');
                    return;
                }

                const validCities = formData.cities.filter(c => c.city && c.startDate && c.endDate);
                if (validCities.length === 0) {
                    alert('Please add at least one complete city with dates');
                    return;
                }

                if (editingId) {
                    const updated = travelers.map(t =>
                        t.id === editingId
                            ? { ...t, name: formData.name, interests: formData.interests, cities: validCities }
                            : t
                    );
                    setTravelers(updated);
                    saveData(updated);
                    setEditingId(null);
                } else {
                    const newTraveler = {
                        id: Date.now(),
                        name: formData.name,
                        interests: formData.interests,
                        cities: validCities
                    };
                    const updated = [...travelers, newTraveler];
                    setTravelers(updated);
                    saveData(updated);
                }

                setFormData({ name: '', interests: '', cities: [{ city: '', startDate: '', endDate: '' }] });
                setShowForm(false);
            };

            const handleEdit = (traveler) => {
                setFormData({
                    name: traveler.name,
                    interests: traveler.interests || '',
                    cities: traveler.cities || [{ city: '', startDate: '', endDate: '' }]
                });
                setEditingId(traveler.id);
                setShowForm(true);
            };

            const handleCancel = () => {
                setFormData({ name: '', interests: '', cities: [{ city: '', startDate: '', endDate: '' }] });
                setEditingId(null);
                setShowForm(false);
            };

            const handleDelete = (id) => {
                if (confirm('Are you sure you want to delete this entry?')) {
                    const updated = travelers.filter(t => t.id !== id);
                    setTravelers(updated);
                    saveData(updated);
                }
            };

            const findOverlapsForCity = (travelerName, city, startDate, endDate) => {
                const start = new Date(startDate);
                const end = new Date(endDate);
                const overlaps = [];

                travelers.forEach(traveler => {
                    if (traveler.name === travelerName) return;

                    const cities = traveler.cities || [];
                    cities.forEach(tc => {
                        if (tc.city === city &&
                            new Date(tc.startDate) <= end &&
                            new Date(tc.endDate) >= start) {
                            overlaps.push({
                                name: traveler.name,
                                interests: traveler.interests,
                                startDate: tc.startDate,
                                endDate: tc.endDate
                            });
                        }
                    });
                });

                return overlaps;
            };

            const formatDate = (dateString) => {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            };

            const getOverlapPeriod = (start1, end1, start2, end2) => {
                const s1 = new Date(start1);
                const e1 = new Date(end1);
                const s2 = new Date(start2);
                const e2 = new Date(end2);

                const overlapStart = s1 > s2 ? s1 : s2;
                const overlapEnd = e1 < e2 ? e1 : e2;

                return `${formatDate(overlapStart)} - ${formatDate(overlapEnd)}`;
            };

            return e('div', { className: 'container' },
                e('div', { className: 'card' },
                    e('div', { className: 'header' },
                        e('div', { className: 'title-container' },
                            e(Icons.Users),
                            e('h1', null, 'Solo Travelers Overlap Finder')
                        ),
                        e('button', {
                            className: 'btn btn-primary',
                            onClick: () => {
                                setEditingId(null);
                                setFormData({ name: '', interests: '', cities: [{ city: '', startDate: '', endDate: '' }] });
                                setShowForm(!showForm);
                            }
                        },
                            e(Icons.Plus),
                            'Add My Trips'
                        )
                    ),
                    showForm && e('div', { className: 'form-container' },
                        e('div', { className: 'form-title' }, editingId ? 'âœï¸ Edit Your Trips' : 'âž• Add Your Trips'),
                        e('div', { className: 'form-group' },
                            e('label', null, 'Your Name *'),
                            e('input', {
                                type: 'text',
                                value: formData.name,
                                onChange: (ev) => setFormData({ ...formData, name: ev.target.value }),
                                placeholder: 'Enter your name'
                            })
                        ),
                        e('div', { className: 'form-group' },
                            e('label', null, 'Interests'),
                            e('input', {
                                type: 'text',
                                value: formData.interests,
                                onChange: (ev) => setFormData({ ...formData, interests: ev.target.value }),
                                placeholder: 'e.g. Food tours, temples, hiking, nightlife'
                            })
                        ),
                        e('div', { className: 'form-group' },
                            e('label', null, 'Cities & Dates *'),
                            formData.cities.map((cityData, index) =>
                                e('div', { key: index, className: 'city-row' },
                                    e('div', { className: 'city-row-container' },
                                        e('div', null,
                                            e('div', { className: 'city-grid' },
                                                e('select', {
                                                    value: cityData.city,
                                                    onChange: (ev) => updateCity(index, 'city', ev.target.value)
                                                },
                                                    e('option', { value: '' }, 'Select city'),
                                                    THAILAND_CITIES.map(city =>
                                                        e('option', { key: city, value: city }, city)
                                                    )
                                                ),
                                                e('input', {
                                                    type: 'date',
                                                    value: cityData.startDate,
                                                    onChange: (ev) => updateCity(index, 'startDate', ev.target.value)
                                                }),
                                                e('input', {
                                                    type: 'date',
                                                    value: cityData.endDate,
                                                    onChange: (ev) => updateCity(index, 'endDate', ev.target.value)
                                                })
                                            )
                                        ),
                                        formData.cities.length > 1 && e('button', {
                                            className: 'btn-icon btn-delete btn-sm',
                                            onClick: () => removeCityField(index)
                                        }, e(Icons.X))
                                    )
                                )
                            ),
                            e('button', { className: 'btn-add-city', onClick: addCityField },
                                e(Icons.Plus),
                                'Add Another City'
                            )
                        ),
                        e('div', { className: 'btn-group' },
                            e('button', { className: 'btn btn-primary', onClick: handleSubmit },
                                editingId ? 'Update Trips' : 'Save All Trips'
                            ),
                            e('button', { className: 'btn btn-secondary', onClick: handleCancel }, 'Cancel')
                        )
                    )
                ),
                travelers.length === 0
                    ? e('div', { className: 'card empty-state' },
                        e('div', { className: 'empty-icon' },
                            e('svg', { className: 'icon-lg', viewBox: '0 0 24 24', fill: 'none', stroke: '#d1d5db', strokeWidth: '2' },
                                e('path', { d: 'M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2' }),
                                e('circle', { cx: '9', cy: '7', r: '4' }),
                                e('path', { d: 'M23 21v-2a4 4 0 0 0-3-3.87' }),
                                e('path', { d: 'M16 3.13a4 4 0 0 1 0 7.75' })
                            )
                        ),
                        e('div', { className: 'empty-title' }, 'No travelers yet'),
                        e('div', { className: 'empty-text' }, 'Click "Add My Trips" to share your travel plans!')
                    )
                    : travelers.map(traveler =>
                        e('div', { key: traveler.id, className: 'traveler-card' },
                            e('div', { className: 'traveler-header' },
                                e('div', null,
                                    e('div', { className: 'traveler-name' }, traveler.name),
                                    traveler.interests && e('div', { className: 'traveler-interests' },
                                        e('strong', null, 'Interests: '),
                                        traveler.interests
                                    )
                                ),
                                e('div', { className: 'action-buttons' },
                                    e('button', { className: 'btn-icon btn-edit', onClick: () => handleEdit(traveler), title: 'Edit' },
                                        e(Icons.Edit)
                                    ),
                                    e('button', { className: 'btn-icon btn-delete', onClick: () => handleDelete(traveler.id), title: 'Delete' },
                                        e(Icons.Trash)
                                    )
                                )
                            ),
                            (traveler.cities || []).map((cityData, idx) => {
                                const overlaps = findOverlapsForCity(traveler.name, cityData.city, cityData.startDate, cityData.endDate);
                                return e('div', { key: idx, className: 'city-card' },
                                    e('div', { className: 'city-name' },
                                        e(Icons.MapPin),
                                        cityData.city
                                    ),
                                    e('div', { className: 'city-dates' },
                                        e(Icons.Calendar),
                                        `${formatDate(cityData.startDate)} - ${formatDate(cityData.endDate)}`
                                    ),
                                    overlaps.length > 0 && e('div', { className: 'overlap-container' },
                                        e('div', { className: 'overlap-header' },
                                            e(Icons.Users),
                                            `Overlapping with ${overlaps.length} traveler${overlaps.length > 1 ? 's' : ''}:`
                                        ),
                                        overlaps.map((other, oidx) =>
                                            e('div', { key: oidx, className: 'overlap-item' },
                                                e('div', { className: 'overlap-name-date' },
                                                    e('span', { className: 'overlap-name' }, other.name),
                                                    e('span', { className: 'overlap-dates' },
                                                        getOverlapPeriod(cityData.startDate, cityData.endDate, other.startDate, other.endDate)
                                                    )
                                                ),
                                                other.interests && e('div', { className: 'overlap-interests' },
                                                    'Interests: ', other.interests
                                                )
                                            )
                                        )
                                    )
                                );
                            })
                        )
                    ),
                e('div', { className: 'footer' },
                    e('p', null, e('strong', null, 'ðŸ’¡ Tip: '), 'Share this link with other solo travelers to find overlap buddies!'),
                    e('p', null, 'All data is stored locally in your browser.')
                )
            );
        }

        ReactDOM.render(React.createElement(TravelOverlapApp), document.getElementById('root'));
    </script>
</body>
</html>